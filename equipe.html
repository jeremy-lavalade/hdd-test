<!DOCTYPE html>
<html lang="fr">

<head>
	<!-- SECTION A MODIFIER -->
	<title>L'Equipe du Film</title>
	<link rel="stylesheet" href="css/equipe.css">

	<!-- SECTION A MODIFIER SELON SI PAGE PRINCIPALE OU SECONDAIRE -->
	<link rel="stylesheet" href="style.css">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
	<script src="script.js"></script>

	<!-- PAS DE MODIFICATION REQUISE -->
	<meta name="keywords" content="cinema, thriller, ecologie, dystopie">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="icon" type="image/png" href="https://www.harmoniedudoutefilm.fr/seo/favicon-hdd.png">
	<meta name="description" content="Face aux défis écologiques, L’Harmonie du Doute est un film à suspense qui explore l'équilibre entre esprit critique et passivité, humains et environnement.">
	<!-- Balises Open Graph pour intégration avec les réseaux sociaux -->
	<meta property="og:title" content="L'Harmonie du Doute - Film">
	<meta property="og:description" content="Face aux défis écologiques, L’Harmonie du Doute est un film à suspense qui explore l'équilibre entre esprit critique et passivité, humains et environnement.">
	<meta property="og:image" content="https://www.harmoniedudoutefilm.fr/seo/logo-hdd.png">
	<meta property="og:url" content="https://www.harmoniedudoutefilm.fr">
	<meta property="og:site_name" content="L'Harmonie du Doute - Film">
	<!-- Liens préchargés pour améliorer les performances de chargement -->
	<link rel="preconnect" href="https://www.harmoniedudoutefilm.fr">
	<!-- Intégration de la feuille de style pour le navigateur Chrome sur Android -->
	<meta name="theme-color" content="#ffffff">
	<!-- Canonical URL pour éviter le contenu dupliqué -->
	<link rel="canonical" href="https://www.harmoniedudoutefilm.fr">
	<!-- Sitemap et Robots pour guider les crawlers des moteurs de recherche -->
	<link rel="sitemap" type="application/xml" title="Sitemap" href="https://www.harmoniedudoutefilm.fr/seo/sitemap.xml">
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.3.3/pixi.min.js"></script>
</head>

<body>

<!-- HEADER -->
	<div id="header"></div>

<!-- CORPS DE LA PAGE -->
	<div id="equipe1">
		<h1 class="light-font center" class="Ymargin15">L'Équipe</h1>
		<div id="equipe-intro-container" class="Xmargin5">
			<p class="light-font justify">Pour garantir la réussite de la présentation de L'Harmonie du Doute dans les salles de cinéma, nous avons structuré notre travail autour de <b><span class="pink-font" style="text-shadow: 0.2px 0.2px 0px #343737;">trois projets</span></b> principaux :<br><br>
			
			1.	Rédaction du <b><span class="pink-font" style="text-shadow: 0.2px 0.2px 0px #343737;">scénario</span></b>,<br>
			2.	Réalisation des <b><span class="pink-font" style="text-shadow: 0.2px 0.2px 0px #343737;">premières minutes du film</span></b> (court-métrage),<br>
			3.	Réalisation du <b><span class="pink-font" style="text-shadow: 0.2px 0.2px 0px #343737;">long-métrage</span></b>.<br><br>

			Notre équipe de services support joue un rôle clé en fournissant une assistance technique et opérationnelle à toutes les divisions, ce qui facilite la coordination des membres des différents projets et la concrétisation de nos objectifs stratégiques.
			</p>
			<img src="images/equipe/intro.webp">
		</div>
		<div id="equipe-pellicule"></div>
	</div>

	<div id="equipe2">
        <h2 class="dark-font center ">Découvrir les membres de l'équipe</h2>
		<ul id="liste-equipe">
	        <li data-target="#realisateurs">Réalisateurs</li>
	        <li data-target="#scenaristes">P1 : Scénaristes</li>
	        <li data-target="#p2-acting">P2 : Interprètes</li>
	        <li data-target="#p2-artistique">P2 : Equipe Artistique</li>
	        <li data-target="#p2-prod">P2 : Equipe Production</li>
	        <li data-target="#p2-technique">P2 : Equipe Technique</li>
	        <li data-target="#p2-postprod">P2 : Post-Production</li>
	        <!--<li data-target="#p3-acting">P3 : Interprètes</li>
	        <li data-target="#p3-artistique">P3 : Equipe Artistique</li>
	        <li data-target="#p3-prod">P3 : Equipe Production</li>
	        <li data-target="#p3-technique">P3 : Equipe Technique</li>
	        <li data-target="#p3-postprod">P3 : Post-Production</li> -->
	        <li data-target="#support">Equipes Support</li>
	    </ul>
	    <div id="equipe-content">
	    	<section id="all" class="section">
	        	<div class="section-container">
	        		<div class="real-container">
	        			<div class="photo-real" style="background-image: url('data/photos-membres/jeremy-lavalade.webp');"></div>
	                    <div class="contact-real">
	                    	<p class="prenom-nom-real">Jérémy LAVALADE</p>
	                    	<p class="poste-real">Co-Réalisateur & Producteur</p>
	                    	<p class="poste-description-real">L'œil du commercial, l'âme du cinéaste.</p>
		                    <div class="real-buttons-container">
		                    	<a class="contact-buttons-real" href="mailto:jeremy.lavalade@harmoniedudoutefilm.fr">
							    	<img class="email-button-real" src="images/icons/contact/light-bkgd/contact-2.webp">
							    </a>
							    <a class="contact-buttons-real" href="https://www.instagram.com/jeremylvld/">
							    	<img class="insta-button-real" src="images/icons/contact/light-bkgd/instagram-2.webp">
							    </a>
							    <a class="son-parcours" href="/equipe/jeremy-lavalade">Découvrir son Parcours</a>
		                    </div>
		                </div>
	                </div>

	                <div class="real-container">
	        			<div class="photo-real" style="background-image: url('data/photos-membres/pablo-freitas.webp');"></div>
	                    <div class="contact-real">
	                    	<p class="prenom-nom-real">Pablo FREÏTAS</p>
	                    	<p class="poste-real">Co-Réalisateur</p>
	                    	<p class="poste-description-real">De l'avant-scène au clap final, Pablo maîtrise chaque nuance dans son nouveau rôle.</p>
		                    <div class="real-buttons-container">
		                    	<a class="contact-buttons-real" href="mailto:pablo.freitas@harmoniedudoutefilm.fr">
							    	<img class="email-button-real" src="images/icons/contact/light-bkgd/contact-2.webp">
							    </a>
							    <a class="contact-buttons-real" href="https://www.instagram.com/pablofrts/">
							    	<img class="insta-button-real" src="images/icons/contact/light-bkgd/instagram-2.webp">
							    </a>
							    <a class="son-parcours" href="/equipe/pablo-freitas">Découvrir son Parcours</a>
		                    </div>
		                </div>
	                </div>
	        	</div>
	        </section>
	        <section id="realisateurs" class="section">
	        	<div class="section-container">
	                <div class="real-container">
	        			<div class="photo-real" style="background-image: url('data/photos-membres/jeremy-lavalade.webp');"></div>
	                    <div class="contact-real">
	                    	<p class="prenom-nom-real">Jérémy LAVALADE</p>
	                    	<p class="poste-real">Co-Réalisateur & Producteur</p>
	                    	<p class="poste-description-real">L'œil du commercial, l'âme du cinéaste.</p>
		                    <div class="real-buttons-container">
		                    	<a class="contact-buttons-real" href="mailto:jeremy.lavalade@harmoniedudoutefilm.fr">
							    	<img class="email-button-real" src="images/icons/contact/light-bkgd/contact-2.webp">
							    </a>
							    <a class="contact-buttons-real" href="https://www.instagram.com/jeremylvld/">
							    	<img class="insta-button-real" src="images/icons/contact/light-bkgd/instagram-2.webp">
							    </a>
							    <a class="son-parcours" href="/equipe/jeremy-lavalade">Découvrir son Parcours</a>
		                    </div>
		                </div>
	                </div>

	                <div class="real-container">
	        			<div class="photo-real" style="background-image: url('data/photos-membres/pablo-freitas.webp');"></div>
	                    <div class="contact-real">
	                    	<p class="prenom-nom-real">Pablo FREÏTAS</p>
	                    	<p class="poste-real">Co-Réalisateur</p>
	                    	<p class="poste-description-real">De l'avant-scène au clap final, Pablo maîtrise chaque nuance dans son nouveau rôle.</p>
		                    <div class="real-buttons-container">
		                    	<a class="contact-buttons-real" href="mailto:pablo.freitas@harmoniedudoutefilm.fr">
							    	<img class="email-button-real" src="images/icons/contact/light-bkgd/contact-2.webp">
							    </a>
							    <a class="contact-buttons-real" href="https://www.instagram.com/pablofrts/">
							    	<img class="insta-button-real" src="images/icons/contact/light-bkgd/instagram-2.webp">
							    </a>
							    <a class="son-parcours" href="/equipe/pablo-freitas">Découvrir son Parcours</a>
		                    </div>
		                </div>
	                </div>
	        	</div>
	        </section>
	        <section id="scenaristes" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	        <section id="p2-acting" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	        <section id="p2-artistique" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	        <section id="p2-prod" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	        <section id="p2-technique" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	        <section id="p2-postprod" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	        <section id="p3-acting" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	        <section id="p3-artistique" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	        <section id="p3-prod" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	        <section id="p3-technique" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	        <section id="p3-postprod" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	        <section id="support" class="section">
	        	<div class="section-container">
	        	</div>
	        </section>
	    </div>

	</div>
<!-- FOOTER -->
	<div id="footer"></div>

<script>
	//PERMET D'AFFICHER LA BONNE SECTION SELON LE CLIQUE DE L'UTILISATEUR
	document.addEventListener('DOMContentLoaded', function() {
	    const sections = document.querySelectorAll('.section');
	    const allSection = document.querySelector('#all');
	    const listeItems = document.querySelectorAll('#liste-equipe li'); // Sélectionne tous les boutons de liste

	    // Fonction pour initialiser l'affichage de toutes les sections
	    const initializeSections = (shouldScroll) => {
	        let hash = window.location.hash.substring(1); // Récupère l'ID depuis le hash de l'URL (sans le #)
	        let foundSection = false;

	        sections.forEach(section => {
	            if (hash && section.id === hash) {
	                section.style.display = 'block'; // Affiche la section correspondant au hash
	                section.classList.add('active');
	                foundSection = true;
	            } else {
	                section.style.display = 'none'; // Cache toutes les autres sections
	                section.classList.remove('active');
	            }
	        });

	        // Si aucun hash correspondant n'est trouvé, affiche "all"
	        if (!foundSection && allSection) {
	            allSection.style.display = 'block';
	            allSection.classList.add('active');
	        }

	        // Met à jour la couleur du bouton correspondant au hash ou le premier si aucun hash
	        listeItems.forEach(btn => {
	            const targetId = btn.getAttribute('data-target').substring(1);
	            if (hash === targetId) {
	                btn.style.backgroundColor = '#E89C9E'; // Applique la couleur rose au bouton cliqué
	            } else {
	                btn.style.backgroundColor = 'inherit'; // Retour à la couleur initiale pour les autres boutons
	            }
	        });

	        // Supprime le hash de l'URL sans recharger la page
			if (foundSection && window.location.hash) {
			    // Remplace temporairement le hash par #equipe2 pour naviguer vers cette section
			    history.replaceState(null, document.title, window.location.pathname + window.location.search + '#equipe2');

			    // Assure le défilement vers la section avec un offset de 90px
			    setTimeout(() => {
			        if (document.getElementById('equipe2')) {
			            const equipe2Offset = document.getElementById('equipe2').offsetTop - 90;
			            window.scrollTo(0, equipe2Offset);
			        }

			        // Supprime le hash visible dans l'URL sans recharger la page
			        history.pushState(null, document.title, window.location.pathname + window.location.search);
			    }, 1); // Un délai de 0 ms suffit pour que la page se positionne avant de nettoyer l'URL
			}
	    };

	    // Appelle la fonction d'initialisation au chargement avec défilement
	    initializeSections(true);

	    // Gestionnaire d'événements pour chaque élément de liste
	    document.querySelectorAll('#liste-equipe li').forEach(item => {
	        item.addEventListener('click', function() {
	            const targetId = this.getAttribute('data-target');

	            // Cache toutes les sections sauf la ciblée
	            sections.forEach(section => {
	                if (section.id !== targetId) {
	                    section.style.display = 'none';
	                    section.classList.remove('active');
	                } else {
	                    section.style.display = 'block';
	                    section.classList.add('active');
	                }
	            });

	            // Met à jour la couleur du bouton actif
	            listeItems.forEach(btn => {
	                if (btn === item) {
	                    btn.style.backgroundColor = '#E89C9E'; // Applique la couleur rose au bouton cliqué
	                } else {
	                    btn.style.backgroundColor = 'inherit'; // Retour à la couleur initiale pour les autres boutons
	                }
	            });

	            // Met à jour le hash dans l'URL
	            window.location.hash = targetId.substring(1);
	        });
	    });

	    // Gère les changements de hash pour mettre à jour la vue
	    window.addEventListener('hashchange', function() {
	        initializeSections(false); // Ne défile pas lors des changements de hash causés par des clics
	    });
	});

	//CHARGE LES INFOS DU MEMBRE DANS L'EXCEL
	document.addEventListener('DOMContentLoaded', function() {
	    const url = "data/liste-equipe.xlsx"; 
	    fetch(url)
	        .then(res => res.arrayBuffer())
	        .then(buffer => {
	            const workbook = XLSX.read(buffer, {type: "buffer"});
	            const firstSheetName = workbook.SheetNames[0];
	            const worksheet = workbook.Sheets[firstSheetName];
	            const data = XLSX.utils.sheet_to_json(worksheet);
	            distributeData(data);
	        });
	});

	function distributeData(data) {
		const allContainer = document.querySelector('#all .section-container');
	    data.forEach(item => {
	        // Ajout d'une vérification pour éviter des erreurs si 'Catégorie' est undefined
	        const category = item['Equipe'] || 'N/A';
	        const lastName = (item['Nom'] || 'N/A').toUpperCase();
	        const firstName = item['Prénom'] || 'N/A';
	        const poste = item['Poste'] || 'N/A';
	        const posteDescription = item['Poste-Description'] || '';
	        const instagram = item['Instagram'] || 'N/A';
	        const email = item['Mail HDD'] || 'N/A';
	        let fullName = `${firstName}-${lastName}`.toLowerCase();
			    // Remplace les accents par des lettres non accentuées
			let photo = fullName.normalize("NFD").replace(/[\u0300-\u036f]/g,"");
			    // Ajoute l'extension de fichier
			    photo += ".webp";

	        const infoHTML = `
				<div class="membre-container">
        			<div class="photo-membre" style="background-image: url('data/photos-membres/${photo}');"></div>
                    <div class="contact-membre">
                    	<p class="prenom-nom">${firstName} ${lastName}</p>
                    	<p class="poste">${poste}</p>
                    	<p class="poste-description">${posteDescription}</p>
	                    <div class="membre-buttons-container">
	                    	<a class="contact-buttons" href="mailto:${email}">
						    	<img class="email-button" src="images/icons/contact/light-bkgd/contact-2.webp">
						    </a>
						    <a class="contact-buttons" href="https://www.instagram.com/${instagram}/">
						    	<img class="insta-button" src="images/icons/contact/light-bkgd/instagram-2.webp">
						    </a>
	                    </div>
	                </div>
                </div>
			    `;

	        const container = document.querySelector(`#${category} .section-container`);
	        if (container) {
	            container.innerHTML += infoHTML;
	        } else {
	            console.error('No container found for category:', category);
	        }

	        if (allContainer) {
	            allContainer.innerHTML += infoHTML;
	        } else {
	            console.error("Section globale 'all' introuvable.");
	        }
	    });
	}

	//CHANGE LA PHOTO DU MEMBRE SI L'URL EST UNE ERREUR
	// Image de remplacement par défaut
	const defaultBackgroundImage = "data/photos-membres/photo-membre-default.webp";

	// Fonction pour vérifier le chargement de l'image
	function verifyBackgroundImage(element, originalUrl) {
	    const testImage = new Image();

	    // Définir le comportement pour un chargement réussi
	    testImage.onload = function () {
	        element.style.backgroundImage = `url('${originalUrl}')`;
	    };

	    // Définir le comportement en cas d'échec de chargement
	    testImage.onerror = function () {
	        element.style.backgroundImage = `url('${defaultBackgroundImage}')`;
	        element.style.border = "1px solid #343737";
	        element.style.backgroundPosition = "center";
	    };

	    // Lancer le chargement de l'image testée
	    testImage.src = originalUrl;
	}

	// Fonction à exécuter après le chargement complet de la page
	function applyDefaultBackgrounds() {
	    // Sélectionner tous les éléments avec la classe 'photo-membre'
	    const photoMembreElements = document.querySelectorAll('.photo-membre');

	    // Vérifier chaque élément
	    photoMembreElements.forEach(function (element) {
	        // Extraire l'URL actuelle de l'image d'arrière-plan
	        const style = window.getComputedStyle(element);
	        const originalUrl = style.backgroundImage.slice(5, -2);

	        // Vérifier et remplacer en cas d'erreur
	        verifyBackgroundImage(element, originalUrl);
	    });
	}

	// Attacher la fonction au chargement complet de la page, puis la lancer avec un délai
	window.addEventListener('load', function () {
	    setTimeout(applyDefaultBackgrounds, 200); // Délai de 200 millisecondes
	});
	
</script>

</body>

</html>